!function(e){function t(t){for(var o,i,u=t[0],c=t[1],s=t[2],d=0,f=[];d<u.length;d++)i=u[d],r[i]&&f.push(r[i][0]),r[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(l&&l(t);f.length;)f.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,u=1;u<n.length;u++){var c=n[u];0!==r[c]&&(o=!1)}o&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={2:0},a=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var u=window.webpackJsonp=window.webpackJsonp||[],c=u.push.bind(u);u.push=t,u=u.slice();for(var s=0;s<u.length;s++)t(u[s]);var l=c;a.push([43,0]),n()}({13:function(e,t,n){"use strict";var o=n(2),r=n(3),a=n(5),i=n(4),u=n(6),c=n(1),s=n(0),l=n.n(s),d=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(a.a)(this,Object(i.a)(t).call(this,e))).canvas=l.a.createRef(),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentDidUpdate",value:function(){this.draw()}},{key:"draw",value:function(){var e=this.props.audioData,t=this.canvas.current,n=t.height,o=t.width,r=t.getContext("2d"),a=0,i=1*o/e.length;r.lineWidth=2,r.strokeStyle="#000000",r.clearRect(0,0,o,n),r.beginPath(),r.moveTo(0,n/2);var u=!0,c=!1,s=void 0;try{for(var l,d=e[Symbol.iterator]();!(u=(l=d.next()).done);u=!0){var f=l.value/255*n;r.lineTo(a,f),a+=i}}catch(p){c=!0,s=p}finally{try{u||null==d.return||d.return()}finally{if(c)throw s}}r.lineTo(a,n/2),r.stroke()}},{key:"render",value:function(){return l.a.createElement("canvas",{width:"300",height:"300",ref:this.canvas})}}]),t}(s.Component);n.d(t,"a",function(){return f});var f=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(a.a)(this,Object(i.a)(t).call(this,e))).audioContext=void 0,n.analyser=void 0,n.dataArray=void 0,n.source=void 0,n.rafId=void 0,n.state={audioData:new Uint8Array(0)},n.tick=n.tick.bind(Object(c.a)(Object(c.a)(n))),n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.audioContext=new window.AudioContext,this.analyser=this.audioContext.createAnalyser(),this.dataArray=new Uint8Array(this.analyser.frequencyBinCount),this.source=this.audioContext.createMediaStreamSource(this.props.audio),this.source.connect(this.analyser),this.rafId=requestAnimationFrame(this.tick)}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.rafId),this.analyser.disconnect(),this.source.disconnect()}},{key:"tick",value:function(){this.analyser.getByteTimeDomainData(this.dataArray),this.setState({audioData:this.dataArray}),this.rafId=requestAnimationFrame(this.tick)}},{key:"render",value:function(){return l.a.createElement(d,{audioData:this.state.audioData})}}]),t}(l.a.Component)},18:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FrameContextConsumer=void 0;var o=n(21);Object.defineProperty(t,"FrameContextConsumer",{enumerable:!0,get:function(){return o.FrameContextConsumer}});var r,a=n(44),i=(r=a)&&r.__esModule?r:{default:r};t.default=i.default},21:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FrameContextConsumer=t.FrameContextProvider=void 0;var o,r=n(0),a=(o=r)&&o.__esModule?o:{default:o};var i=void 0,u=void 0;"undefined"!==typeof document&&(i=document),"undefined"!==typeof window&&(u=window);var c=a.default.createContext({document:i,window:u}),s=c.Provider,l=c.Consumer;t.FrameContextProvider=s,t.FrameContextConsumer=l},43:function(e,t,n){"use strict";n.r(t);var o=n(7),r=n.n(o),a=n(10),i=n(2),u=n(3),c=n(5),s=n(4),l=n(6),d=n(1),f=n(13),p=n(0),h=n.n(p),v=n(12),y=n.n(v),m=n(18),b=n.n(m),g=(n(46),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(s.a)(t).call(this,e))).state={audio:null},n.state={test:null},n.toggleMicrophone=n.toggleMicrophone.bind(Object(d.a)(Object(d.a)(n))),n}return Object(l.a)(t,e),Object(u.a)(t,[{key:"setAudioGlobalStore",value:function(){var e=Object(a.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:t=e.sent,this.setState({audio:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getMicrophone",value:function(){var e=Object(a.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:t=e.sent,this.setState({audio:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"stopMicrophone",value:function(){this.state.audio.getTracks().forEach(function(e){return e.stop()}),this.setState({audio:null})}},{key:"toggleMicrophone",value:function(){this.state.audio?this.stopMicrophone():this.getMicrophone()}},{key:"testButton",value:function(){var e=document.createEvent("Event");e.initEvent("hello"),document.dispatchEvent(e)}},{key:"render",value:function(){var e=this;return h.a.createElement(b.a,{head:[h.a.createElement("link",{type:"text/css",rel:"stylesheet",href:chrome.runtime.getURL("/static/css/content.css")})]},h.a.createElement(m.FrameContextConsumer,null,function(t){t.document,t.window;return h.a.createElement("div",{className:"my-extension"},h.a.createElement("h1",null,"I wish this would work :("),h.a.createElement("button",{onClick:e.toggleMicrophone},e.state.audio?"Stop microphone":"Get microphone input"),e.state.audio?h.a.createElement(f.a,{audio:e.state.audio}):"",h.a.createElement("button",{onClick:e.testButton},e.state.test?"SpotifyIsDumb":"LoginToSpotify"))}))}}]),t}(h.a.Component)),O=document.createElement("div");O.id="my-extension-root",O.style.display="none",chrome.runtime.onMessage.addListener(function(e,t,n){"clicked_browser_action"===e.message&&("none"===O.style.display?O.style.display="block":O.style.display="none")}),document.body.appendChild(O),y.a.render(h.a.createElement(g,null),O),document.addEventListener("hello",function(e){chrome.runtime.sendMessage("test")})},44:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),i=d(a),u=d(n(12)),c=d(n(8)),s=n(21),l=d(n(45));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.handleLoad=function(){o.forceUpdate()},o._isMounted=!1,o}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){this._isMounted=!0;var e=this.getDoc();e&&"complete"===e.readyState?this.forceUpdate():this.node.addEventListener("load",this.handleLoad)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.node.removeEventListener("load",this.handleLoad)}},{key:"getDoc",value:function(){return this.node.contentDocument}},{key:"getMountTarget",value:function(){var e=this.getDoc();return this.props.mountTarget?e.querySelector(this.props.mountTarget):e.body.children[0]}},{key:"renderFrameContents",value:function(){if(!this._isMounted)return null;var e=this.getDoc(),t=this.props.contentDidMount,n=this.props.contentDidUpdate,o=e.defaultView||e.parentView,r=!this._setInitialContent,a=i.default.createElement(l.default,{contentDidMount:t,contentDidUpdate:n},i.default.createElement(s.FrameContextProvider,{value:{document:e,window:o}},i.default.createElement("div",{className:"frame-content"},this.props.children)));r&&(e.open("text/html","replace"),e.write(this.props.initialContent),e.close(),this._setInitialContent=!0);var c=this.getMountTarget();return[u.default.createPortal(this.props.head,this.getDoc().head),u.default.createPortal(a,c)]}},{key:"render",value:function(){var e=this,t=o({},this.props,{children:void 0});return delete t.head,delete t.initialContent,delete t.mountTarget,delete t.contentDidMount,delete t.contentDidUpdate,i.default.createElement("iframe",o({},t,{ref:function(t){return e.node=t}}),this.renderFrameContents())}}]),t}();f.propTypes={style:c.default.object,head:c.default.node,initialContent:c.default.string,mountTarget:c.default.string,contentDidMount:c.default.func,contentDidUpdate:c.default.func,children:c.default.oneOfType([c.default.element,c.default.arrayOf(c.default.element)])},f.defaultProps={style:{},head:null,children:void 0,mountTarget:void 0,contentDidMount:function(){},contentDidUpdate:function(){},initialContent:'<!DOCTYPE html><html><head></head><body><div class="frame-root"></div></body></html>'},t.default=f},45:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),a=(i(r),i(n(8)));function i(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"componentDidMount",value:function(){this.props.contentDidMount()}},{key:"componentDidUpdate",value:function(){this.props.contentDidUpdate()}},{key:"render",value:function(){return r.Children.only(this.props.children)}}]),t}();u.propTypes={children:a.default.element.isRequired,contentDidMount:a.default.func.isRequired,contentDidUpdate:a.default.func.isRequired},t.default=u},46:function(e,t,n){}});
//# sourceMappingURL=content.js.map